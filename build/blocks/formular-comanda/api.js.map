{"version":3,"file":"blocks/formular-comanda/api.js","mappings":"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","sources":["webpack://@wp-mos/blocks/./src/blocks/formular-comanda/api.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n  let totalPrice = null;\n  let filesData = [];\n  let lastWrapperId = 0;\n  let totalPriceElm = null;\n\n  const loader = \"…\";\n  const formGroup = document.querySelector(\".form-group\");\n  const apiUrl = \"https://lasercut.internetguru.io/api/v2/analyze?id=mos\";\n\n  const orderForm = document.getElementById(\"mos-order-form\");\n\n  // UTILS\n  const initFilesData = (formGroupId, formGroup) => {\n    filesData[formGroupId] = {\n      formGroup: formGroup,\n      status: null,\n      lastMod: null,\n      material: null,\n      quantity: null,\n      file: null,\n      fileHash: null,\n      fileURL: null,\n      fileWidth: null,\n      fileHeight: null,\n      productPrice: null,\n      addedWrapper: false,\n      valid: false,\n    };\n  };\n\n  const formatPrice = (num) => {\n    return num.toLocaleString();\n  };\n\n  const formatSize = (num) => {\n    return Math.round(num);\n  };\n\n  const getValidFilesCnt = () => {\n    cnt = 0;\n    filesData.forEach((file) => {\n      if (file == null) {\n        return;\n      }\n      if (!file.valid) {\n        return;\n      }\n      cnt++;\n    });\n    return cnt;\n  };\n\n  // FORM GROUP LISTENER\n  const addFileGroupListener = (formGroup, fileGroupId) => {\n    formGroup.addEventListener(\"change\", (event) => {\n      calculatePrice(fileGroupId);\n    });\n\n    formGroup\n      .querySelector(\".form-quantity\")\n      .addEventListener(\"keydown\", (event) => {\n        if (event.key === \"Enter\") {\n          calculatePrice(fileGroupId);\n          event.preventDefault();\n        }\n        if (event.keyCode == 9) {\n          calculatePrice(fileGroupId);\n        }\n      });\n  };\n\n  const addFormGroup = (formGroup, fileGroupId) => {\n    let newWrapper = formGroup.cloneNode(true);\n    lastWrapperId++;\n    initFilesData(lastWrapperId, newWrapper);\n    newWrapper.setAttribute(\"data-filenum\", lastWrapperId);\n    newWrapper.querySelector(\".form-filestatus\").innerHTML = \"-\";\n    newWrapper.querySelector(\".form-file\").value = \"\";\n    newWrapper.querySelector(\".form-quantity\").value = 1;\n    newWrapper.querySelector(\".form-size\").innerHTML = \"-\";\n    formGroup.querySelector(\".form-wrapper\").insertAdjacentHTML(\n      \"beforeend\",\n      `<a class=\"form-del\" data-id=\"${fileGroupId}\" href=\"Javascript:void(0);\">\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6 18L18 6\" stroke=\"black\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          <path d=\"M18 18L6 6\" stroke=\"black\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n        </svg>\n      </a>`\n    );\n    fileInput = formGroup.querySelector(\".form-file\");\n    fileName = document.createElement(\"p\");\n    fileName.className = \"mt-2 mb-0\";\n    fileName.innerHTML = fileInput.files[0].name;\n    fileInput.parentNode.replaceChild(fileName, fileInput);\n    formGroup.querySelector(\".form-del\").addEventListener(\"click\", (event) => {\n      filesData[event.currentTarget.getAttribute(\"data-id\")] = null;\n      formGroup.parentNode.removeChild(formGroup);\n      updateForm();\n    });\n    addFileGroupListener(newWrapper, lastWrapperId);\n    formGroup.parentNode.insertBefore(newWrapper, formGroup.nextElementSibling);\n  };\n\n  const updateForm = (fileGroupId) => {\n    totalPrice = 0;\n    filesData.forEach((file) => {\n      if (file == null || file.prices == null) {\n        return;\n      }\n      if (\n        fileGroupId !== undefined &&\n        fileGroupId == file.formGroup.getAttribute(\"data-filenum\")\n      ) {\n        file.status.innerHTML = loader;\n      }\n      var materialSelect = file.formGroup.querySelector(\".form-material\");\n      if (materialSelect.children.length == 1) {\n        materialSelect.innerHTML = \"\";\n        file.prices.forEach((priceData) => {\n          var option = document.createElement(\"option\");\n          option.value = priceData.material_id;\n          option.innerHTML = `${priceData.material_name}`;\n          option.setAttribute(\"data-name\", priceData.material_name);\n          materialSelect.appendChild(option);\n        });\n      }\n      var quantity = file.formGroup.querySelector(\".form-quantity\").value;\n      var price =\n        file.prices[materialSelect.selectedIndex].unit_price * quantity +\n        file.prices[materialSelect.selectedIndex].fix_price;\n      setTimeout(() => {\n        file.status.innerHTML = `${formatPrice(price)} RON`;\n      }, 400);\n      width = formatSize(file.fileWidth);\n      height = formatSize(file.fileHeight);\n      file.formGroup.querySelector(\n        \".form-size\"\n      ).innerHTML = `${width} × ${height}`;\n\n      // show form details\n      file.formGroup\n        .querySelector(\".form-block-details\")\n        .classList.remove(\"hide\");\n\n      // add file name as title\n      file.formGroup.querySelector(\n        \".form-block-details-title\"\n      ).innerHTML = `${file.file.name}`;\n\n      // disable upload file button\n      file.formGroup\n        .querySelector(\".form-subscribe-button\")\n        .classList.add(\"disabled\");\n\n      // show total price\n      document.querySelector(\".form-price\").classList.remove(\"hide\");\n\n      // show submit\n      document.querySelector(\".form-submit-button\").classList.remove(\"hide\");\n\n      file.productPrice = price;\n      totalPrice += price;\n      file.material =\n        materialSelect[materialSelect.selectedIndex].getAttribute(\"data-name\");\n    });\n    totalPriceElm.innerHTML = `${formatPrice(totalPrice)} RON`;\n  };\n\n  const calculatePrice = (fileGroupId) => {\n    const formGroup = filesData[fileGroupId].formGroup;\n    const fileInputElement = formGroup.querySelector(\".form-file\");\n    const material = formGroup.querySelector(\".form-material\").value;\n    const materialName =\n      formGroup.querySelector(\".form-material\").selectedOptions[0].text;\n    const quantity = formGroup.querySelector(\".form-quantity\").value;\n    const status = formGroup.querySelector(\".form-filestatus\");\n    let file = null;\n    if (filesData[fileGroupId].file == null) {\n      if (!fileInputElement.value) {\n        status.innerHTML = \"Choose file\";\n        return false;\n      }\n      file = fileInputElement.files[0];\n    } else {\n      file = filesData[fileGroupId].file;\n    }\n    if (quantity < 1 || quantity > 200) {\n      status.innerHTML = \"Quantity must be between 1 and 200\";\n      return false;\n    }\n    const fileName = file.name;\n    const lastMod = file.lastModified + fileName;\n    filesData[fileGroupId].quantity = quantity;\n    if (filesData[fileGroupId].lastMod !== lastMod) {\n      filesData[fileGroupId].status = status;\n      filesData[fileGroupId].material = materialName;\n      filesData[fileGroupId].lastMod = lastMod;\n      var form = new FormData();\n      form.append(\"material\", material);\n      form.append(\"amount\", quantity);\n      if (\n        filesData[fileGroupId].valid &&\n        filesData[fileGroupId].fileHash !== null\n      ) {\n        form.append(\"hash\", filesData[fileGroupId].fileHash);\n      } else {\n        form.append(\"dxf_file\", file, fileName);\n      }\n      status.innerHTML = loader;\n\n      fetch(apiUrl, {\n        method: \"post\",\n        body: form,\n      })\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          }\n          return response.json().then((text) => {\n            throw new Error(text.message);\n          });\n        })\n        .then((result) => {\n          filesData[fileGroupId].prices = result.prices;\n          filesData[fileGroupId].materialPrices = result.prices;\n          filesData[fileGroupId].fileHash = result.file_hash;\n          filesData[fileGroupId].fileURL = result.filew_path;\n          filesData[fileGroupId].fileWidth = result.model_width;\n          filesData[fileGroupId].fileHeight = result.model_height;\n          filesData[fileGroupId].file = file;\n          filesData[fileGroupId].valid = true;\n          if (!filesData[fileGroupId].addedWrapper) {\n            // addFormGroup(formGroup, fileGroupId);\n            filesData[fileGroupId].addedWrapper = true;\n          }\n          updateForm(fileGroupId);\n        })\n        .catch((error) => {\n          alert(error);\n          status.innerHTML = \"–\";\n          filesData[fileGroupId].lastMod = null;\n          filesData[fileGroupId].valid = false;\n        });\n      return;\n    }\n    filesData[fileGroupId].material = quantity;\n    filesData[fileGroupId].material = materialName;\n    updateForm(fileGroupId);\n    filesData[fileGroupId].valid = true;\n  };\n\n  function saveFormData(form) {\n    const formData = new FormData(form);\n    for (let [name, value] of formData) {\n      var label = document.querySelector(`label[for=\"${name}\"]`).innerHTML;\n      // customer.push({ key: name, value: value, label: label });\n      const varname = document\n        .getElementById(name)\n        .getAttribute(\"data-varname\");\n      if (varname) {\n        window[varname] = value;\n      }\n    }\n  }\n\n  initFilesData(0, formGroup);\n  totalPriceElm = document.getElementById(\"order-price\");\n  addFileGroupListener(formGroup, 0);\n  formGroup.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n    if (getValidFilesCnt() == 0) {\n      return false;\n    }\n    var msg = document.querySelector(\".status-message\");\n    if (msg) {\n      msg.parentNode.removeChild(msg);\n    }\n  });\n\n  orderForm.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    const formData = new FormData(orderForm);\n\n    filesData.forEach((data) => {\n      formData.append(\"price\", data.productPrice);\n    });\n\n    var xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", mos_auth_rest.order);\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          const response = JSON.parse(xhr.responseText);\n          console.log(response);\n        } else {\n          console.log(\"error\");\n        }\n      }\n    };\n    xhr.send(formData);\n  });\n});\n"],"names":["document","addEventListener","totalPrice","filesData","lastWrapperId","totalPriceElm","loader","formGroup","querySelector","apiUrl","orderForm","getElementById","initFilesData","formGroupId","status","lastMod","material","quantity","file","fileHash","fileURL","fileWidth","fileHeight","productPrice","addedWrapper","valid","formatPrice","num","toLocaleString","formatSize","Math","round","getValidFilesCnt","cnt","forEach","addFileGroupListener","fileGroupId","event","calculatePrice","key","preventDefault","keyCode","addFormGroup","newWrapper","cloneNode","setAttribute","innerHTML","value","insertAdjacentHTML","fileInput","fileName","createElement","className","files","name","parentNode","replaceChild","currentTarget","getAttribute","removeChild","updateForm","insertBefore","nextElementSibling","prices","undefined","materialSelect","children","length","priceData","option","material_id","material_name","appendChild","price","selectedIndex","unit_price","fix_price","setTimeout","width","height","classList","remove","add","fileInputElement","materialName","selectedOptions","text","lastModified","form","FormData","append","fetch","method","body","then","response","ok","json","Error","message","result","materialPrices","file_hash","filew_path","model_width","model_height","catch","error","alert","saveFormData","formData","label","varname","window","msg","data","xhr","XMLHttpRequest","open","mos_auth_rest","order","onreadystatechange","readyState","JSON","parse","responseText","console","log","send"],"sourceRoot":""}