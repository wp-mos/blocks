{"version":3,"file":"blocks/formular-comanda/api.js","mappings":"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","sources":["webpack://@wp-mos/blocks/./src/blocks/formular-comanda/api.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n  const apiUrl = \"https://lasercut.internetguru.io/api/v2/analyze?id=mos\";\n\n  const orderForm = document.getElementById(\"mos-order-form\");\n  const formGroup = document.querySelector(\".order-form-group\");\n  const totalPriceElm = document.getElementById(\"order-form-total-price\");\n  const addGroup = document.getElementById(\"order-form-add\");\n\n  const data = [];\n  const loader = \"...\";\n  let prevId = 0;\n\n  let totalPrice = null;\n\n  // Init data\n  const initData = (id, group) => {\n    data[id] = {\n      group: group,\n      status: null,\n      price: null,\n      lastMod: null,\n      material: null,\n      quantity: null,\n      file: null,\n      fileHash: null,\n      fileURL: null,\n      fileWidth: null,\n      fileHeight: null,\n      productPrice: null,\n      addedGroup: false,\n      valid: false,\n    };\n  };\n\n  // Listen for form group change\n  const formGroupListener = (group, id) => {\n    group.addEventListener(\"change\", () => {\n      // getResult(id);\n    });\n  };\n\n  const updateGroup = (id) => {\n    totalPrice = 0;\n    data.forEach((group) => {\n      if (group === null || group.prices === null) {\n        return;\n      }\n\n      if (id && id === group.group.getAttribute(\"data-id\")) {\n        group.status.innerHTML = loader;\n      }\n\n      const materialSelect = group.group.querySelector(\".order-form-material\");\n\n      if (materialSelect.children.length == 1) {\n        materialSelect.innerHTML = \"\";\n\n        group.prices.forEach((priceData) => {\n          const option = document.createElement(\"option\");\n          option.value = priceData.material_id;\n          option.innerHTML = `${priceData.material_name}`;\n          option.setAttribute(\"data-name\", priceData.material_name);\n          materialSelect.appendChild(option);\n        });\n      }\n\n      const quantity = group.group.querySelector(\".order-form-quantity\").value;\n      const price =\n        group.prices[materialSelect.selectedIndex].unit_price * quantity +\n        group.prices[materialSelect.selectedIndex].fix_price;\n\n      setTimeout(() => {\n        group.status.innerHTML = `${Math.round(price)} RON`;\n      }, 300);\n\n      let width = Math.round(group.fileWidth);\n      let height = Math.round(group.fileHeight);\n\n      group.group.querySelector(\n        \".order-form-dimensions\"\n      ).innerHTML = `${width} x ${height} mm`;\n\n      group.group.productPrice = price;\n      totalPrice += price;\n      group.material =\n        materialSelect[materialSelect.selectedIndex].getAttribute(\"data-name\");\n    });\n    totalPriceElm.innerHTML = `${Math.round(totalPrice)} RON`;\n  };\n\n  // Update form group\n  const getResult = (id) => {\n    const group = data[id].group;\n    const groupFile = group.querySelector(\".order-form-file\");\n    const groupMaterial = group.querySelector(\".order-form-material\");\n    const groupQuantity = group.querySelector(\".order-form-quantity\");\n    const formStatus = group.querySelector(\".order-form-status\");\n\n    // Get material & quantity values\n    const groupMaterialValue = groupMaterial.value;\n    const groupQuantityValue = groupQuantity.value;\n\n    // Get material name\n    const groupMaterialName =\n      groupMaterial.options[groupMaterial.selectedIndex].text;\n\n    // Get file\n    let file = null;\n    if (data[id].file == null) {\n      if (!groupFile.value) {\n        formStatus.innerHTML = \"No file selected.\";\n        return;\n      }\n      file = groupFile.files[0];\n    } else {\n      file = data[id].file;\n    }\n\n    // Check if quantity is valid\n    if (groupQuantityValue < 1 || groupQuantityValue > 100) {\n      formStatus.innerHTML = \"Quantity must be between 1 and 100.\";\n      return;\n    }\n\n    const fileName = file.name;\n    const lastMod = file.lastModified + fileName;\n\n    // Set quantity\n    data[id].quantity = groupQuantityValue;\n\n    if (data[id].lastMod !== lastMod) {\n      data[id].status = formStatus;\n      data[id].material = groupMaterialValue;\n      data[id].lastMod = lastMod;\n\n      const form = new FormData();\n      form.append(\"material\", groupMaterialValue);\n      form.append(\"amount\", groupQuantityValue);\n\n      if (data[id].valid && data[id].fileHash !== null) {\n        form.append(\"hash\", data[id].fileHash);\n      } else {\n        form.append(\"dxf_file\", file, fileName);\n      }\n\n      formStatus.innerHTML = loader;\n\n      fetch(apiUrl, {\n        method: \"POST\",\n        body: form,\n      })\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          }\n          return response.json().then((text) => {\n            throw new Error(text.message);\n          });\n        })\n        .then((result) => {\n          data[id].prices = result.prices;\n          data[id].materialPrices = result.prices;\n          data[id].fileHash = result.file_hash;\n          data[id].fileURL = result.file_path;\n          data[id].fileWidth = result.model_width;\n          data[id].fileHeight = result.model_height;\n          data[id].file = file;\n          data[id].valid = true;\n          if (!data[id].group) {\n            // add new group\n            data[id].addedGroup = true;\n          }\n          updateGroup(id);\n        })\n        .catch((error) => {\n          console.log(error);\n          formStatus.innerHTML = error;\n          data[id].lastMod = null;\n          data[id].valid = false;\n        });\n      return;\n    }\n\n    data[id].material = groupMaterialValue;\n    updateGroup(id);\n    data[id].valid = true;\n  };\n\n  const buildBlock = (id) => {\n    const newGroup = document.createElement(\"div\");\n    newGroup.classList.add(\"order-form-group\");\n    newGroup.dataset.id = `${id}`;\n\n    // Add file block\n    const fileBlock = document.createElement(\"div\");\n    fileBlock.classList.add(\"order-form-block\");\n    const formBlockLabel = document.createElement(\"label\");\n    formBlockLabel.classList.add(\"order-form-label\");\n    formBlockLabel.setAttribute(\"for\", `file-${id}`);\n    formBlockLabel.innerHTML = \"DXF File\";\n    const formBlockInput = document.createElement(\"input\");\n    formBlockInput.classList.add(\"order-form-file\");\n    formBlockInput.setAttribute(\"type\", \"file\");\n    formBlockInput.setAttribute(\"name\", `file-${id}`);\n    formBlockInput.setAttribute(\"required\", true);\n    fileBlock.appendChild(formBlockLabel);\n    fileBlock.appendChild(formBlockInput);\n\n    // Add material block\n    const materialBlock = document.createElement(\"div\");\n    materialBlock.classList.add(\"order-form-block\");\n    const materialBlockLabel = document.createElement(\"label\");\n    materialBlockLabel.classList.add(\"order-form-label\");\n    materialBlockLabel.setAttribute(\"for\", `material-${id}`);\n    materialBlockLabel.innerHTML = \"Material\";\n    const materialBlockSelect = document.createElement(\"select\");\n    materialBlockSelect.classList.add(\"order-form-material\");\n    materialBlockSelect.setAttribute(\"name\", `material-${id}`);\n    materialBlockSelect.setAttribute(\"required\", true);\n    const materialBlockSelectOption = document.createElement(\"option\");\n    materialBlockSelectOption.innerHTML = \"Choose file\";\n    materialBlockSelectOption.setAttribute(\"value\", \"\");\n    materialBlockSelect.appendChild(materialBlockSelectOption);\n    materialBlock.appendChild(materialBlockLabel);\n    materialBlock.appendChild(materialBlockSelect);\n\n    // Add quantity block\n    const quantityBlock = document.createElement(\"div\");\n    quantityBlock.classList.add(\"order-form-block\");\n    const quantityBlockLabel = document.createElement(\"label\");\n    quantityBlockLabel.classList.add(\"order-form-label\");\n    quantityBlockLabel.setAttribute(\"for\", `quantity-${id}`);\n    quantityBlockLabel.innerHTML = \"Quantity\";\n    const quantityBlockInput = document.createElement(\"input\");\n    quantityBlockInput.classList.add(\"order-form-quantity\");\n    quantityBlockInput.setAttribute(\"name\", `quantity-${id}`);\n    quantityBlockInput.setAttribute(\"type\", \"number\");\n    quantityBlockInput.setAttribute(\"required\", true);\n    quantityBlockInput.setAttribute(\"min\", 1);\n    quantityBlockInput.setAttribute(\"max\", 100);\n    quantityBlockInput.setAttribute(\"value\", 1);\n    quantityBlock.appendChild(quantityBlockLabel);\n    quantityBlock.appendChild(quantityBlockInput);\n\n    // Add status block\n    const statusBlock = document.createElement(\"div\");\n    statusBlock.classList.add(\"order-form-block\");\n    const statusBlockDimensions = document.createElement(\"div\");\n    statusBlockDimensions.classList.add(\"order-form-dimensions\");\n    statusBlockDimensions.innerHTML = \"-\";\n    const statusBlockPrice = document.createElement(\"div\");\n    statusBlockPrice.classList.add(\"order-form-status\");\n    statusBlockPrice.innerHTML = \"-\";\n    statusBlock.appendChild(statusBlockDimensions);\n    statusBlock.appendChild(statusBlockPrice);\n\n    newGroup.appendChild(fileBlock);\n    newGroup.appendChild(materialBlock);\n    newGroup.appendChild(quantityBlock);\n    newGroup.appendChild(statusBlock);\n    orderForm.insertBefore(newGroup, totalPriceElm);\n    return newGroup;\n  };\n\n  const addGroupHandler = (event) => {\n    event.preventDefault();\n    prevId++;\n    let newGroup = buildBlock(prevId);\n    initData(prevId, newGroup);\n    formGroupListener(newGroup, prevId);\n  };\n\n  // Add new group\n  addGroup.addEventListener(\"click\", addGroupHandler);\n\n  const init = () => {\n    initData(0, formGroup);\n    formGroupListener(formGroup, 0);\n  };\n\n  init();\n\n  // Get auth token\n  function getAuthToken() {\n    // Try to get the auth token from the cookie\n    const authToken = getCookie(\"auth_token\");\n    if (authToken) {\n      return authToken;\n    }\n  }\n\n  // Get cookie\n  function getCookie(name) {\n    const value = `; ${document.cookie}`;\n    const parts = value.split(`; ${name}=`);\n    if (parts.length === 2) {\n      return parts.pop().split(\";\").shift();\n    }\n  }\n\n  // submit form\n  orderForm.addEventListener(\"submit\", (event) => {\n    const formData = new FormData(orderForm);\n\n    formData.append(\"title\", \"Product title\");\n    formData.append(\"description\", \"Product description\");\n    formData.append(\"price\", \"100\");\n\n    const authToken = getAuthToken();\n\n    const request = new XMLHttpRequest();\n    request.open(\"POST\", mos_auth_rest.order, true);\n    request.setRequestHeader(\"Accept\", \"application/json\");\n    request.setRequestHeader(\"Authorization\", \"Bearer \" + authToken);\n\n    request.onload = () => {\n      if (request.status === 200) {\n        const response = JSON.parse(request.responseText);\n        console.log(response);\n      } else {\n        console.log(\"error\");\n      }\n    };\n    request.send(formData);\n    event.preventDefault();\n  });\n\n  orderForm.reset();\n});\n"],"names":["document","addEventListener","apiUrl","orderForm","getElementById","formGroup","querySelector","totalPriceElm","addGroup","data","loader","prevId","totalPrice","initData","id","group","status","price","lastMod","material","quantity","file","fileHash","fileURL","fileWidth","fileHeight","productPrice","addedGroup","valid","formGroupListener","updateGroup","forEach","prices","getAttribute","innerHTML","materialSelect","children","length","priceData","option","createElement","value","material_id","material_name","setAttribute","appendChild","selectedIndex","unit_price","fix_price","setTimeout","Math","round","width","height","getResult","groupFile","groupMaterial","groupQuantity","formStatus","groupMaterialValue","groupQuantityValue","groupMaterialName","options","text","files","fileName","name","lastModified","form","FormData","append","fetch","method","body","then","response","ok","json","Error","message","result","materialPrices","file_hash","file_path","model_width","model_height","catch","error","console","log","buildBlock","newGroup","classList","add","dataset","fileBlock","formBlockLabel","formBlockInput","materialBlock","materialBlockLabel","materialBlockSelect","materialBlockSelectOption","quantityBlock","quantityBlockLabel","quantityBlockInput","statusBlock","statusBlockDimensions","statusBlockPrice","insertBefore","addGroupHandler","event","preventDefault","init","getAuthToken","authToken","getCookie","cookie","parts","split","pop","shift","formData","request","XMLHttpRequest","open","mos_auth_rest","order","setRequestHeader","onload","JSON","parse","responseText","send","reset"],"sourceRoot":""}