{"version":3,"file":"blocks/order-form/api.js","mappings":"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","sources":["webpack://@wp-mos/blocks/./src/blocks/order-form/api.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n  let totalPrice = null;\n  let filesData = [];\n  let lastWrapperId = 0;\n  let totalPriceElm = null;\n\n  const loader = \"…\";\n  const formGroup = document.querySelector(\".form-group\");\n  const apiUrl = \"https://lasercut.internetguru.io/api/v2/analyze?id=mos\";\n\n  // UTILS\n  const initFilesData = (formGroupId, formGroup) => {\n    filesData[formGroupId] = {\n      formGroup: formGroup,\n      status: null,\n      lastMod: null,\n      material: null,\n      quantity: null,\n      file: null,\n      fileHash: null,\n      fileURL: null,\n      fileWidth: null,\n      fileHeight: null,\n      productPrice: null,\n      addedWrapper: false,\n      valid: false,\n    };\n  };\n\n  const formatPrice = (num) => {\n    return num.toLocaleString();\n  };\n\n  const formatSize = (num) => {\n    return Math.round(num);\n  };\n\n  const getValidFilesCnt = () => {\n    cnt = 0;\n    filesData.forEach((file) => {\n      if (file == null) {\n        return;\n      }\n      if (!file.valid) {\n        return;\n      }\n      cnt++;\n    });\n    return cnt;\n  };\n\n  // FRONTEND\n  const toggleFormBlocks = (formBlocks) => {\n    formBlocks.forEach((formBlock, index) => {\n      const formBlockHeader = formBlock.querySelector(\".form-block-header\");\n\n      let isOpen = false;\n\n      index === 0 ? (isOpen = true) : (isOpen = false);\n\n      formBlockHeader.addEventListener(\"click\", (event) => {\n        event.preventDefault();\n\n        formBlocks.forEach((block) => {\n          isOpen = false;\n          block.classList.add(\"disabled\");\n        });\n\n        !isOpen\n          ? formBlock.classList.remove(\"disabled\")\n          : formBlock.classList.add(\"disabled\");\n        isOpen = !isOpen;\n      });\n    });\n  };\n\n  const initFormBlocks = (formGroup) => {\n    const formBlocks = formGroup.querySelectorAll(\".form-block\");\n    const formFile = formGroup.querySelector(\".form-file\");\n    const formSelect = formGroup.querySelector(\".form-select\");\n\n    const el = [];\n\n    // init\n    formBlocks.forEach((formBlock, index) => {\n      if (index !== 0) {\n        formBlock.classList.add(\"disabled\");\n      } else {\n        el.push(formBlocks[0]);\n        toggleFormBlocks(el);\n      }\n    });\n\n    const closeAllFormBlocks = () => {\n      formBlocks.forEach((formBlock) => {\n        formBlock.classList.add(\"disabled\");\n      });\n    };\n\n    const openFormBlock = (id) => {\n      formBlocks.forEach((formBlock, index) => {\n        if (index === id) {\n          formBlock.classList.remove(\"disabled\");\n        }\n      });\n    };\n\n    formFile.addEventListener(\"change\", (event) => {\n      if (event) {\n        closeAllFormBlocks();\n        openFormBlock(1);\n        el.push(formBlocks[1]);\n        toggleFormBlocks(el);\n      }\n    });\n\n    formSelect.addEventListener(\"change\", (event) => {\n      if (event) {\n        closeAllFormBlocks();\n        openFormBlock(2);\n        el.push(formBlocks[2]);\n        toggleFormBlocks(el);\n      }\n    });\n  };\n\n  // FORM GROUP LISTENER\n  const addFileGroupListener = (formGroup, fileGroupId) => {\n    formGroup.addEventListener(\"change\", (event) => {\n      calculatePrice(fileGroupId);\n    });\n    initFormBlocks(formGroup, fileGroupId);\n    formGroup\n      .querySelector(\".form-quantity\")\n      .addEventListener(\"keydown\", (event) => {\n        if (event.key === \"Enter\") {\n          calculatePrice(fileGroupId);\n          event.preventDefault();\n        }\n        if (event.keyCode == 9) {\n          calculatePrice(fileGroupId);\n        }\n      });\n  };\n\n  const addFormGroup = (formGroup, fileGroupId) => {\n    let newWrapper = formGroup.cloneNode(true);\n    lastWrapperId++;\n    initFilesData(lastWrapperId, newWrapper);\n    newWrapper.setAttribute(\"data-filenum\", lastWrapperId);\n    newWrapper.querySelector(\".form-filestatus\").innerHTML = \"–\";\n    newWrapper.querySelector(\".form-file\").value = \"\";\n    newWrapper.querySelector(\".form-quantity\").value = 1;\n    newWrapper.querySelector(\".form-size\").innerHTML = \"–\";\n    formGroup.querySelector(\".form-wrapper\").insertAdjacentHTML(\n      \"beforeend\",\n      `<a class=\"form-del\" data-id=\"${fileGroupId}\" href=\"Javascript:void(0);\">\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6 18L18 6\" stroke=\"black\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          <path d=\"M18 18L6 6\" stroke=\"black\" stroke-width=\"1.5\" stroke-miterlimit=\"10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n        </svg>\n      </a>`\n    );\n    fileInput = formGroup.querySelector(\".form-file\");\n    fileName = document.createElement(\"p\");\n    fileName.className = \"mt-2 mb-0\";\n    fileName.innerHTML = fileInput.files[0].name;\n    fileInput.parentNode.replaceChild(fileName, fileInput);\n    formGroup.querySelector(\".form-del\").addEventListener(\"click\", (event) => {\n      filesData[event.currentTarget.getAttribute(\"data-id\")] = null;\n      formGroup.parentNode.removeChild(formGroup);\n      updateForm();\n    });\n    addFileGroupListener(newWrapper, lastWrapperId);\n    formGroup.parentNode.insertBefore(newWrapper, formGroup.nextElementSibling);\n  };\n\n  const updateForm = (fileGroupId) => {\n    totalPrice = 0;\n    filesData.forEach((file) => {\n      if (file == null || file.prices == null) {\n        return;\n      }\n      if (\n        fileGroupId !== undefined &&\n        fileGroupId == file.formGroup.getAttribute(\"data-filenum\")\n      ) {\n        file.status.innerHTML = loader;\n      }\n      var materialSelect = file.formGroup.querySelector(\".form-material\");\n      if (materialSelect.children.length == 1) {\n        materialSelect.innerHTML = \"\";\n        file.prices.forEach((priceData) => {\n          var option = document.createElement(\"option\");\n          option.value = priceData.material_id;\n          option.innerHTML = `${priceData.material_name}`;\n          option.setAttribute(\"data-name\", priceData.material_name);\n          materialSelect.appendChild(option);\n        });\n      }\n      var quantity = file.formGroup.querySelector(\".form-quantity\").value;\n      var price =\n        file.prices[materialSelect.selectedIndex].unit_price * quantity +\n        file.prices[materialSelect.selectedIndex].fix_price;\n      setTimeout(() => {\n        file.status.innerHTML = `${formatPrice(price)} RON`;\n      }, 400);\n      width = formatSize(file.fileWidth);\n      height = formatSize(file.fileHeight);\n      file.formGroup.querySelector(\n        \".form-size\"\n      ).innerHTML = `${width} × ${height}`;\n\n      // show form details\n      file.formGroup\n        .querySelector(\".form-block-details\")\n        .classList.remove(\"hide\");\n\n      // add file name as title\n      file.formGroup.querySelector(\n        \".form-block-details-title\"\n      ).innerHTML = `${file.file.name}`;\n\n      // show total price\n      document.querySelector(\".form-price\").classList.remove(\"hide\");\n\n      file.productPrice = price;\n      totalPrice += price;\n      file.material =\n        materialSelect[materialSelect.selectedIndex].getAttribute(\"data-name\");\n    });\n    totalPriceElm.innerHTML = `${formatPrice(totalPrice)} RON`;\n  };\n\n  const calculatePrice = (fileGroupId) => {\n    const formGroup = filesData[fileGroupId].formGroup;\n    const fileInputElement = formGroup.querySelector(\".form-file\");\n    const material = formGroup.querySelector(\".form-material\").value;\n    const materialName =\n      formGroup.querySelector(\".form-material\").selectedOptions[0].text;\n    const quantity = formGroup.querySelector(\".form-quantity\").value;\n    const status = formGroup.querySelector(\".form-filestatus\");\n    let file = null;\n    if (filesData[fileGroupId].file == null) {\n      if (!fileInputElement.value) {\n        status.innerHTML = \"Choose file\";\n        return false;\n      }\n      file = fileInputElement.files[0];\n    } else {\n      file = filesData[fileGroupId].file;\n    }\n    if (quantity < 1 || quantity > 100) {\n      status.innerHTML = \"Quantity must be between 1 and 100\";\n      return false;\n    }\n    const fileName = file.name;\n    const lastMod = file.lastModified + fileName;\n    filesData[fileGroupId].quantity = quantity;\n    if (filesData[fileGroupId].lastMod !== lastMod) {\n      filesData[fileGroupId].status = status;\n      filesData[fileGroupId].material = materialName;\n      filesData[fileGroupId].lastMod = lastMod;\n      var form = new FormData();\n      form.append(\"material\", material);\n      form.append(\"amount\", quantity);\n      if (\n        filesData[fileGroupId].valid &&\n        filesData[fileGroupId].fileHash !== null\n      ) {\n        form.append(\"hash\", filesData[fileGroupId].fileHash);\n      } else {\n        form.append(\"dxf_file\", file, fileName);\n      }\n      status.innerHTML = loader;\n\n      fetch(apiUrl, {\n        method: \"post\",\n        body: form,\n      })\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          }\n          return response.json().then((text) => {\n            throw new Error(text.message);\n          });\n        })\n        .then((result) => {\n          filesData[fileGroupId].prices = result.prices;\n          filesData[fileGroupId].materialPrices = result.prices;\n          filesData[fileGroupId].fileHash = result.file_hash;\n          filesData[fileGroupId].fileURL = result.filew_path;\n          filesData[fileGroupId].fileWidth = result.model_width;\n          filesData[fileGroupId].fileHeight = result.model_height;\n          filesData[fileGroupId].file = file;\n          filesData[fileGroupId].valid = true;\n          if (!filesData[fileGroupId].addedWrapper) {\n            addFormGroup(formGroup, fileGroupId);\n            filesData[fileGroupId].addedWrapper = true;\n          }\n          updateForm(fileGroupId);\n        })\n        .catch((error) => {\n          alert(error);\n          status.innerHTML = \"–\";\n          filesData[fileGroupId].lastMod = null;\n          filesData[fileGroupId].valid = false;\n        });\n      return;\n    }\n    filesData[fileGroupId].material = quantity;\n    filesData[fileGroupId].material = materialName;\n    updateForm(fileGroupId);\n    filesData[fileGroupId].valid = true;\n  };\n\n  function saveFormData(form) {\n    const formData = new FormData(form);\n    for (let [name, value] of formData) {\n      var label = document.querySelector(`label[for=\"${name}\"]`).innerHTML;\n      customer.push({ key: name, value: value, label: label });\n      const varname = document\n        .getElementById(name)\n        .getAttribute(\"data-varname\");\n      if (varname) {\n        window[varname] = value;\n      }\n    }\n    console.log(formData);\n  }\n\n  initFilesData(0, formGroup);\n  totalPriceElm = document.getElementById(\"order-price\");\n  addFileGroupListener(formGroup, 0);\n  formGroup.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n    if (getValidFilesCnt() == 0) {\n      return false;\n    }\n    var msg = document.querySelector(\".status-message\");\n    if (msg) {\n      msg.parentNode.removeChild(msg);\n    }\n  });\n});\n"],"names":["document","addEventListener","totalPrice","filesData","lastWrapperId","totalPriceElm","loader","formGroup","querySelector","apiUrl","initFilesData","formGroupId","status","lastMod","material","quantity","file","fileHash","fileURL","fileWidth","fileHeight","productPrice","addedWrapper","valid","formatPrice","num","toLocaleString","formatSize","Math","round","getValidFilesCnt","cnt","forEach","toggleFormBlocks","formBlocks","formBlock","index","formBlockHeader","isOpen","event","preventDefault","block","classList","add","remove","initFormBlocks","querySelectorAll","formFile","formSelect","el","push","closeAllFormBlocks","openFormBlock","id","addFileGroupListener","fileGroupId","calculatePrice","key","keyCode","addFormGroup","newWrapper","cloneNode","setAttribute","innerHTML","value","insertAdjacentHTML","fileInput","fileName","createElement","className","files","name","parentNode","replaceChild","currentTarget","getAttribute","removeChild","updateForm","insertBefore","nextElementSibling","prices","undefined","materialSelect","children","length","priceData","option","material_id","material_name","appendChild","price","selectedIndex","unit_price","fix_price","setTimeout","width","height","fileInputElement","materialName","selectedOptions","text","lastModified","form","FormData","append","fetch","method","body","then","response","ok","json","Error","message","result","materialPrices","file_hash","filew_path","model_width","model_height","catch","error","alert","saveFormData","formData","label","customer","varname","getElementById","window","console","log","msg"],"sourceRoot":""}