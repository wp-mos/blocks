{"version":3,"file":"blocks/order-form/frontend.js","mappings":"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","sources":["webpack://@wp-mos/blocks/./src/blocks/order-form/frontend.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n  // TODO check valid\n  let valid = true;\n  let speed = null;\n  let delivery = null;\n  let totalPrice = null;\n  let totalPriceDph = null;\n  let status = null;\n  let customer = [];\n  let filesData = [];\n  let lastWrapperId = 0;\n  let totalPriceElm = null;\n  let totalPriceDphElm = null;\n\n  function addFileWrapperListener(fileWrapper, wrapId) {\n    fileWrapper.addEventListener(\"change\", (event) => {\n      calculatePrice(wrapId);\n    });\n    fileWrapper\n      .querySelector(\".form-quantity\")\n      .addEventListener(\"keydown\", (event) => {\n        if (event.key === \"Enter\") {\n          calculatePrice(wrapId);\n          event.preventDefault();\n        }\n        if (event.keyCode == 9) {\n          calculatePrice(wrapId);\n        }\n      });\n  }\n\n  // function addFileWrapper(fileWrapper, wrapId) {\n  //   let newWrapper = fileWrapper.cloneNode(true);\n  //   lastWrapperId++;\n  //   initFilesData(lastWrapperId, newWrapper);\n  //   newWrapper.setAttribute(\"data-filenum\", lastWrapperId);\n  //   newWrapper.querySelector(\".form-filestatus\").innerHTML = \"–\";\n  //   newWrapper.querySelector(\".form-file\").value = \"\";\n  //   newWrapper.querySelector(\".form-quantity\").value = 1;\n  //   newWrapper.querySelector(\".form-size\").innerHTML = \"–\";\n  //   // newWrapper.querySelector('.form-fileid').innerHTML = '–'\n\n  //   fileWrapper\n  //     .querySelector(\".col\")\n  //     .insertAdjacentHTML(\n  //       \"beforeend\",\n  //       `<a class=\"form-del btn btn-outline-dark border-0 w-auto mt-0 position-absolute top-0 end-0\" data-id=\"${wrapId}\" href=\"Javascript:void(0);\"><span class=\"bi-x-lg\"></span></a>`\n  //     );\n  //   fileWrapper\n  //     .querySelector(\".form-filestatus\")\n  //     .insertAdjacentHTML(\n  //       \"afterend\",\n  //       `<div><div></div><a class=\"form-calc btn btn-primary btn-sm\" title=\"Recalculate\" href=\"Javascript:void(0);\"><span class=\"bi-arrow-clockwise fs-5\"></span></a></div>`\n  //     );\n\n  //   // fileInput = fileWrapper.querySelector(\".form-file\");\n\n  //   fileName = document.createElement(\"p\");\n  //   fileName.className = \"mt-2 mb-0\";\n  //   fileName.innerHTML = `<strong>${fileInput.files[0].name}</strong> a fost incarcat cu succes!`;\n  //   fileInput.parentNode.replaceChild(fileName, fileInput);\n  //   fileWrapper\n  //     .querySelector(\".form-del\")\n  //     .addEventListener(\"click\", (event) => {\n  //       filesData[event.currentTarget.getAttribute(\"data-id\")] = null;\n  //       fileWrapper.parentNode.removeChild(fileWrapper);\n  //       updateForm();\n  //     });\n  //   fileWrapper\n  //     .querySelector(\".form-calc\")\n  //     .addEventListener(\"click\", (event) => {\n  //       calculatePrice(wrapId);\n  //     });\n  //   addFileWrapperListener(newWrapper, lastWrapperId);\n  //   fileWrapper.parentNode.insertBefore(\n  //     newWrapper,\n  //     fileWrapper.nextElementSibling\n  //   );\n  // }\n  function addFileWrapper(fileWrapper, wrapId) {\n    let newWrapper = fileWrapper.cloneNode(true);\n    lastWrapperId++;\n    initFilesData(lastWrapperId, newWrapper);\n    newWrapper.setAttribute(\"data-filenum\", lastWrapperId);\n    newWrapper.querySelector(\".form-filestatus\").innerHTML = \"–\";\n    newWrapper.querySelector(\".form-file\").value = \"\";\n    newWrapper.querySelector(\".form-quantity\").value = 1;\n    newWrapper.querySelector(\".form-size\").innerHTML = \"–\";\n    // newWrapper.querySelector('.form-fileid').innerHTML = '–'\n    fileWrapper\n      .querySelector(\".col\")\n      .insertAdjacentHTML(\n        \"beforeend\",\n        `<a class=\"form-del btn btn-outline-dark border-0 w-auto mt-0 position-absolute top-0 end-0\" data-id=\"${wrapId}\" href=\"Javascript:void(0);\"><span class=\"bi-x-lg\"></span></a>`\n      );\n    fileWrapper\n      .querySelector(\".form-filestatus\")\n      .insertAdjacentHTML(\n        \"afterend\",\n        `<div><div></div><a class=\"form-calc btn btn-primary btn-sm\" title=\"Recalculate\" href=\"Javascript:void(0);\"><span class=\"bi-arrow-clockwise fs-5\"></span></a></div>`\n      );\n    fileInput = fileWrapper.querySelector(\".form-file\");\n    fileName = document.createElement(\"p\");\n    fileName.className = \"mt-2 mb-0\";\n    fileName.innerHTML = fileInput.files[0].name;\n    fileInput.parentNode.replaceChild(fileName, fileInput);\n    fileWrapper\n      .querySelector(\".form-del\")\n      .addEventListener(\"click\", (event) => {\n        filesData[event.currentTarget.getAttribute(\"data-id\")] = null;\n        fileWrapper.parentNode.removeChild(fileWrapper);\n        updateForm();\n      });\n    fileWrapper\n      .querySelector(\".form-calc\")\n      .addEventListener(\"click\", (event) => {\n        calculatePrice(wrapId);\n      });\n    addFileWrapperListener(newWrapper, lastWrapperId);\n    fileWrapper.parentNode.insertBefore(\n      newWrapper,\n      fileWrapper.nextElementSibling\n    );\n  }\n\n  function initFilesData(wrapperId, wrapperElm) {\n    filesData[wrapperId] = {\n      fileWrapper: wrapperElm,\n      status: null,\n      lastMod: null,\n      material: null,\n      quantity: null,\n      file: null,\n      fileHash: null,\n      fileURL: null,\n      fileWidth: null,\n      fileHeight: null,\n      productPrice: null,\n      addedWrapper: false,\n      valid: false,\n    };\n  }\n\n  function formatPrice(num) {\n    return num.toLocaleString(\"cs-CZ\");\n  }\n\n  function formatSize(num) {\n    return Math.round(num);\n    //return num.replace(/\\..*$/, '')\n  }\n\n  function updateForm(wrapId) {\n    totalPrice = 0;\n    filesData.forEach((file) => {\n      if (file == null || file.prices == null) {\n        return;\n      }\n      if (\n        wrapId !== undefined &&\n        wrapId == file.fileWrapper.getAttribute(\"data-filenum\")\n      ) {\n        file.status.innerHTML = loader;\n      }\n      var materialSelect = file.fileWrapper.querySelector(\".form-material\");\n      if (materialSelect.children.length == 1) {\n        materialSelect.innerHTML = \"\";\n        file.prices.forEach((priceData) => {\n          var option = document.createElement(\"option\");\n          option.value = priceData.material_id;\n          // option.innerHTML = `${priceData.materialName} (`\n          // + formatPrice(priceData.fixPrice) + ' Kč fix + '\n          // + formatPrice(priceData.unitPrice) + ` Kč za 1 ks)`\n          option.innerHTML = `${priceData.material_name}`;\n          option.setAttribute(\"data-name\", priceData.material_name);\n          materialSelect.appendChild(option);\n        });\n      }\n      var quantity = file.fileWrapper.querySelector(\".form-quantity\").value;\n      var price =\n        file.prices[materialSelect.selectedIndex].unit_price * quantity +\n        file.prices[materialSelect.selectedIndex].fix_price;\n      setTimeout(() => {\n        file.status.innerHTML = `${formatPrice(price)} €`;\n      }, 400);\n      width = formatSize(file.fileWidth);\n      height = formatSize(file.fileHeight);\n      file.fileWrapper.querySelector(\n        \".form-size\"\n      ).innerHTML = `${width} × ${height}`;\n      // file.fileWrapper.querySelector('.form-fileid').innerHTML = `${file.fileHash}`\n      file.productPrice = price;\n      totalPrice += price;\n      file.material =\n        materialSelect[materialSelect.selectedIndex].getAttribute(\"data-name\");\n    });\n    //totalPrice = Math.round(totalPrice * speed)\n    //totalPriceDph = Math.round(totalPrice * 1.21)\n    totalPriceElm.innerHTML = `${formatPrice(totalPrice)} €`;\n  }\n\n  function getValidFilesCnt() {\n    cnt = 0;\n    filesData.forEach((file) => {\n      if (file == null) {\n        return;\n      }\n      if (!file.valid) {\n        return;\n      }\n      cnt++;\n    });\n    return cnt;\n  }\n\n  function calculatePrice(wrapId) {\n    const fileWrapper = filesData[wrapId].fileWrapper;\n    const fileInputElement = fileWrapper.querySelector(\".form-file\");\n    const material = fileWrapper.querySelector(\".form-material\").value;\n    const materialName =\n      fileWrapper.querySelector(\".form-material\").selectedOptions[0].text;\n    const quantity = fileWrapper.querySelector(\".form-quantity\").value;\n    const status = fileWrapper.querySelector(\".form-filestatus\");\n    let file = null;\n    if (filesData[wrapId].file == null) {\n      if (!fileInputElement.value) {\n        status.innerHTML = \"Choose file\";\n        return false;\n      }\n      file = fileInputElement.files[0];\n    } else {\n      file = filesData[wrapId].file;\n    }\n    if (quantity < 1 || quantity > 100) {\n      status.innerHTML = \"Quantity must be between 1 and 100\";\n      return false;\n    }\n    const fileName = file.name;\n    const lastMod = file.lastModified + fileName;\n    filesData[wrapId].quantity = quantity;\n    if (filesData[wrapId].lastMod !== lastMod) {\n      filesData[wrapId].status = status;\n      filesData[wrapId].material = materialName;\n      filesData[wrapId].lastMod = lastMod;\n      var form = new FormData();\n      form.append(\"material\", material);\n      form.append(\"amount\", quantity);\n      if (filesData[wrapId].valid && filesData[wrapId].fileHash !== null) {\n        form.append(\"hash\", filesData[wrapId].fileHash);\n      } else {\n        form.append(\"dxf_file\", file, fileName);\n      }\n      status.innerHTML = loader;\n      fetch(apiUrl, {\n        method: \"post\",\n        body: form,\n      })\n        .then((response) => {\n          if (response.ok) {\n            return response.json();\n          }\n          return response.json().then((text) => {\n            throw new Error(text.message);\n          });\n        })\n        .then((result) => {\n          // filesData[wrapId].productPrice = parseInt(result.price)\n          filesData[wrapId].prices = result.prices;\n          filesData[wrapId].materialPrices = result.prices;\n          filesData[wrapId].fileHash = result.file_hash;\n          filesData[wrapId].fileURL = result.filew_path;\n          filesData[wrapId].fileWidth = result.model_width;\n          filesData[wrapId].fileHeight = result.model_height;\n          filesData[wrapId].file = file;\n          filesData[wrapId].valid = true;\n          if (!filesData[wrapId].addedWrapper) {\n            addFileWrapper(fileWrapper, wrapId);\n            filesData[wrapId].addedWrapper = true;\n          }\n          updateForm(wrapId);\n        })\n        .catch((error) => {\n          alert(error);\n          status.innerHTML = \"–\";\n          filesData[wrapId].lastMod = null;\n          filesData[wrapId].valid = false;\n        });\n      return;\n    }\n    filesData[wrapId].material = quantity;\n    filesData[wrapId].material = materialName;\n    updateForm(wrapId);\n    filesData[wrapId].valid = true;\n  }\n\n  function saveFormData(form) {\n    const formData = new FormData(form);\n    for (let [name, value] of formData) {\n      var label = document.querySelector(`label[for=\"${name}\"]`).innerHTML;\n      customer.push({ key: name, value: value, label: label });\n      const varname = document\n        .getElementById(name)\n        .getAttribute(\"data-varname\");\n      if (varname) {\n        window[varname] = value;\n      }\n    }\n  }\n\n  const loader = \"…\";\n  const fileWrapper = document.querySelector(\".form-group\");\n  const id = \"mos\";\n  const apiUrl =\n    \"https://lasercut.internetguru.io/api/v2/analyze\" + (id ? \"?id=\" + id : \"\");\n\n  initFilesData(0, fileWrapper);\n  totalPriceElm = document.getElementById(\"order-price\");\n  addFileWrapperListener(fileWrapper, 0);\n  fileWrapper.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n    if (getValidFilesCnt() == 0) {\n      // TODO highlight error\n      return false;\n    }\n    var msg = document.querySelector(\".status-message\");\n    if (msg) {\n      msg.parentNode.removeChild(msg);\n    }\n  });\n  document.querySelector(\".form-placeholder\").style.display = \"none\";\n  document.querySelector(\".form-placeholder + form\").style.display = \"block\";\n});\n"],"names":["document","addEventListener","valid","speed","delivery","totalPrice","totalPriceDph","status","customer","filesData","lastWrapperId","totalPriceElm","totalPriceDphElm","addFileWrapperListener","fileWrapper","wrapId","event","calculatePrice","querySelector","key","preventDefault","keyCode","addFileWrapper","newWrapper","cloneNode","initFilesData","setAttribute","innerHTML","value","insertAdjacentHTML","fileInput","fileName","createElement","className","files","name","parentNode","replaceChild","currentTarget","getAttribute","removeChild","updateForm","insertBefore","nextElementSibling","wrapperId","wrapperElm","lastMod","material","quantity","file","fileHash","fileURL","fileWidth","fileHeight","productPrice","addedWrapper","formatPrice","num","toLocaleString","formatSize","Math","round","forEach","prices","undefined","loader","materialSelect","children","length","priceData","option","material_id","material_name","appendChild","price","selectedIndex","unit_price","fix_price","setTimeout","width","height","getValidFilesCnt","cnt","fileInputElement","materialName","selectedOptions","text","lastModified","form","FormData","append","fetch","apiUrl","method","body","then","response","ok","json","Error","message","result","materialPrices","file_hash","filew_path","model_width","model_height","catch","error","alert","saveFormData","formData","label","push","varname","getElementById","window","id","msg","style","display"],"sourceRoot":""}